<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>검증 기능 테스트</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="p-8">
    <h1 class="text-2xl mb-4">검증 기능 테스트</h1>
    
    <div class="space-y-4">
        <div class="bg-blue-50 p-4 rounded">
            <h2 class="font-bold mb-2">1. 검증 상태 요소 확인</h2>
            <button onclick="checkElements()" class="bg-blue-500 text-white px-3 py-1 rounded mr-2">요소 확인</button>
            <button onclick="testDirectUpdate()" class="bg-green-500 text-white px-3 py-1 rounded mr-2">직접 업데이트</button>
            <div id="elementResult" class="mt-2 text-sm"></div>
        </div>
        
        <div class="bg-gray-50 p-4 rounded">
            <h2 class="font-bold mb-2">2. 검증 상태 섹션 (실제 HTML 구조)</h2>
            <p class="text-sm font-semibold">검증 상태</p>
            <div id="dataValidation" class="mt-2 border p-2 bg-white rounded">
                <!-- 여기에 검증 결과가 표시되어야 함 -->
            </div>
        </div>
        
        <div class="bg-yellow-50 p-4 rounded">
            <h2 class="font-bold mb-2">3. 검증 함수 테스트</h2>
            <button onclick="testSampleData()" class="bg-yellow-500 text-white px-3 py-1 rounded mr-2">샘플 데이터 설정</button>
            <button onclick="testValidation()" class="bg-orange-500 text-white px-3 py-1 rounded mr-2">검증 실행</button>
            <div id="testResult" class="mt-2 text-sm"></div>
        </div>
    </div>
    
    <script>
        // 전역 변수 (메인 파일과 동일)
        let currentData = null;
        let autoProgress = true;
        let analysisResults = {};
        
        // 요소 존재 확인
        function checkElements() {
            const validation = document.getElementById('dataValidation');
            const result = document.getElementById('elementResult');
            
            result.innerHTML = `
                <div>dataValidation 요소: ${validation ? '✅ 존재' : '❌ 없음'}</div>
                <div>innerHTML: "${validation?.innerHTML || 'undefined'}"</div>
                <div>classList: ${validation?.className || 'undefined'}</div>
            `;
        }
        
        // 직접 업데이트 테스트
        function testDirectUpdate() {
            const validation = document.getElementById('dataValidation');
            if (validation) {
                validation.innerHTML = '<div class="text-green-600 text-sm"><div class="font-medium">✅ 직접 업데이트 성공</div></div>';
                console.log('직접 업데이트 성공');
            } else {
                console.error('dataValidation 요소가 없음');
            }
        }
        
        // 샘플 데이터 설정
        function testSampleData() {
            currentData = {
                '그룹': ['A', 'A', 'A', 'B', 'B', 'B'],
                '값': [10, 12, 14, 15, 17, 19]
            };
            
            document.getElementById('testResult').innerHTML = '샘플 데이터 설정 완료: ' + JSON.stringify(currentData);
            console.log('샘플 데이터 설정:', currentData);
        }
        
        // 검증 함수 테스트 (메인 파일에서 복사)
        function testValidation() {
            console.log('testValidation 시작');
            
            if (!currentData) {
                document.getElementById('testResult').innerHTML = '먼저 샘플 데이터를 설정하세요.';
                return;
            }
            
            // performBasicValidation 함수 일부 로직
            const columns = Object.keys(currentData);
            const rows = currentData[columns[0]]?.length || 0;
            
            console.log('데이터 구조:', { rows, columns: columns.length });
            
            // 간단한 검증 결과 생성
            const validationHtml = `
                <div class="text-green-600 text-sm">
                    <div class="font-medium">✅ 품질 검사 통과</div>
                    <div class="text-xs mt-1">
                        ${columns.length}개 열, ${rows}개 행
                    </div>
                </div>
            `;
            
            console.log('검증 HTML 생성:', validationHtml);
            
            // dataValidation 업데이트
            const validationElement = document.getElementById('dataValidation');
            if (validationElement) {
                validationElement.innerHTML = validationHtml;
                console.log('dataValidation 업데이트 성공');
                document.getElementById('testResult').innerHTML = '검증 완료 - dataValidation 업데이트됨';
            } else {
                console.error('dataValidation 요소를 찾을 수 없음');
                document.getElementById('testResult').innerHTML = '❌ dataValidation 요소를 찾을 수 없음';
            }
        }
        
        console.log('테스트 페이지 로드 완료');
    </script>
</body>
</html>