# Step 2: 데이터 확인 - 상세 명세

**버전**: 1.0.0
**최종 수정일**: 2025-01-17
**단계 번호**: 2/5

[← 전체 워크플로우로 돌아가기](./README.md) | [← Step 1](./STEP1_DATA_UPLOAD_SPEC.md) | [Step 3 →](./STEP3_ANALYSIS_GOAL_SPEC.md)

---

## 🔍 단계 개요

| 항목 | 내용 |
|-----|------|
| **목적** | 분석 전 반드시 확인해야 할 데이터 특성을 자동으로 검증 |
| **설명** | 데이터를 자동으로 검증합니다 |
| **아이콘** | CheckCircle |
| **예상 소요시간** | 5-15초 (자동 처리) |
| **선행 조건** | Step 1 완료 (데이터 업로드) |
| **다음 단계** | Step 3: 분석 목표 설정 |
| **핵심 원칙** | "분석의 신뢰성을 보장하기 위한 최소 필수 검증" |

## 2.1 UI 구성 - 3개 핵심 탭

### 탭 구성 개요
| 탭 번호 | 탭 이름 | 목적 | 기본 선택 |
|---------|---------|------|-----------|
| 1 | 데이터 프로파일 | 데이터 전체 구조 파악 | ✅ |
| 2 | 분포 진단 | 통계적 가정 사전 체크 | - |
| 3 | 분석 로드맵 | 가능한 분석 방법 안내 | - |

## 2.2 탭 1: 데이터 프로파일 (Data Profile)

### 2.2.1 상단 요약 카드

#### 레이아웃
```
┌────────────────────────────────────────────────────────┐
│  📊 데이터 요약                                         │
│                                                        │
│  관측치: 5,432개    변수: 23개                         │
│  수치형: 15개       범주형: 8개                        │
│  완전성: 94.7%      분석 준비도: 🟢 준비됨              │
└────────────────────────────────────────────────────────┘
```

#### 분석 준비도 판정 기준
- 🟢 **준비됨**: 결측률 < 10%, 치명적 문제 없음
- 🟡 **확인 필요**: 결측률 10-30%, 경미한 문제 존재
- 🔴 **문제 있음**: 결측률 > 30%, 분석 불가능한 문제

### 2.2.2 변수 요약 테이블

#### 테이블 구조
| 변수명 | 타입 | 유효N | 결측률 | 핵심통계 | 문제 플래그 |
|--------|------|-------|--------|----------|-------------|
| PatientID | 범주형 | 100 | 0% | 100개 고유값 | - |
| Age | 수치형 | 98 | 2% | μ=35.2, σ=12.3 | - |
| Income | 수치형 | 95 | 5% | μ=52340, σ=23450 | ⚠️ 왜도 |
| Gender | 범주형 | 100 | 0% | 3개 범주 | - |
| Score | 수치형 | 100 | 0% | μ=72.4, σ=15.2 | - |

#### 핵심통계 표시 규칙
- **수치형**: 평균(μ), 표준편차(σ)
- **범주형**: 고유값 개수 또는 최빈값
- **날짜형**: 기간 범위

#### 문제 플래그 유형
- ⚠️ **왜도**: |왜도| > 2
- ⚠️ **이상치**: 극단값 존재
- ⚠️ **불균형**: 범주 비율 극단적
- ❌ **오류**: 음수 나이 등 논리적 오류

### 2.2.3 데이터 타입 자동 분류

#### 분류 알고리즘
```python
if 고유값 <= 전체의 5% and 문자형:
    타입 = "범주형"
elif 숫자만 존재 and 고유값 > 전체의 5%:
    타입 = "수치형"
elif 날짜 패턴 매칭:
    타입 = "날짜형"
else:
    타입 = "혼합형" (경고)
```

## 2.3 탭 2: 분포 진단 (Distribution Diagnostics)

### 2.3.1 정규성 평가

#### 표시 형식
```
📊 정규성 검정 결과 (Shapiro-Wilk, n>30일 때만 수행)

정규분포 따름:
✅ Age: p=0.234 (정규성 만족)
✅ Height: p=0.456 (정규성 만족)

정규분포 따르지 않음:
❌ Income: p<0.001 (우측 꼬리)
   → 권장: 로그 변환 log(Income)
❌ Rating: p<0.001 (왼쪽 치우침)
   → 권장: 비모수 검정 사용

경계선:
⚠️ Score: p=0.048
   → 권장: 표본 크기가 크면 모수, 작으면 비모수
```

#### 검정 수행 조건
- n ≥ 30: Shapiro-Wilk 검정
- n < 30: "표본 크기 부족" 메시지
- 범주형 변수: 검정 생략

### 2.3.2 이상치 진단

#### 이상치 탐지 방법
```
IQR 방법 (기본):
- 하한: Q1 - 1.5 × IQR
- 상한: Q3 + 1.5 × IQR
- 극단 이상치: Q1 - 3 × IQR, Q3 + 3 × IQR
```

#### 표시 형식
```
🔍 이상치 탐지 결과

Income (수치형):
• 경미한 이상치: 12개 (2.2%)
• 극단 이상치: 3개 (0.6%) - [250000, 280000, 999999]
→ 권장 조치:
  1) Winsorizing (상하위 5% 대체)
  2) 제거 (극단값만)
  3) 로그 변환

Age (수치형):
• 이상치 없음 ✅
```

### 2.3.3 분산 구조 진단

#### 등분산성 검정 (그룹 변수 존재 시)
```
📊 그룹별 등분산성 검정 (Levene's test)

Gender별 Income:
❌ 이분산 검출 (p=0.003)
→ 사용: Welch's t-test (일반 t-test 대신)

Treatment별 Score:
✅ 등분산 가정 만족 (p=0.342)
→ 사용: 일반 ANOVA 가능
```

## 2.4 탭 3: 분석 로드맵 (Analysis Roadmap)

### 2.4.1 즉시 가능한 분석 (Green Light) 🟢

```
✅ 즉시 실행 가능한 분석:

기술통계:
• 평균, 중앙값, 표준편차
• 빈도분석, 교차표
• 상관분석 (Pearson, Spearman)

비모수 검정 (분포 가정 불필요):
• Mann-Whitney U test
• Wilcoxon signed-rank test
• Kruskal-Wallis test
• 카이제곱 검정

시각화:
• 히스토그램, 박스플롯
• 산점도, 막대 차트
```

### 2.4.2 조건부 가능 (Yellow Light) 🟡

```
⚠️ 전처리 후 가능한 분석:

t-검정 계열:
• 조건: Income 로그 변환 필요
• 대안: 비모수 검정 사용

회귀분석:
• 조건: 다중공선성 확인 (VIF < 10)
• 주의: 이상치 처리 필요

분산분석 (ANOVA):
• 조건: 그룹별 표본 크기 균형 확인
• 주의: 등분산성 위반 시 Welch's ANOVA
```

### 2.4.3 데이터 보강 필요 (Red Light) 🔴

```
❌ 현재 불가능한 분석:

시계열 분석:
• 필요: 시간 변수 (날짜/시간)
• 현재: 시간 정보 없음

생존분석:
• 필요: 사건 발생 시간, 중도절단 정보
• 현재: 해당 변수 없음

요인분석:
• 필요: 최소 3개 이상 관련 변수
• 현재: 변수 수 부족

다수준 분석:
• 필요: 계층적 구조 (학교-학생 등)
• 현재: 단일 수준 데이터
```

## 2.5 자동 검증 프로세스

### 2.5.1 처리 흐름

```
Step 1 데이터 수신
    ↓
타입 자동 분류 (2초)
    ↓
기초 통계 계산 (3초)
    ↓
분포 진단 (5초)
    ↓
분석 가능성 평가 (2초)
    ↓
결과 표시 (총 12초)
```

### 2.5.2 Step 1과 역할 분담

#### Step 1에서 완료 (재사용)
- 파일 메타데이터 (이름, 크기, 인코딩)
- 기본 구조 (행, 열 수)
- 파싱 성공 여부

#### Step 2에서만 수행
- 변수 타입 분류
- 통계적 분포 진단
- 분석 방법 추천

## 2.6 사용자 액션

### 2.6.1 주요 버튼

| 버튼 | 기능 | 위치 |
|------|------|------|
| [다음 단계] | Step 3로 진행 | 우하단 (기본) |
| [데이터 수정] | 전처리 도구 열기 | 좌하단 |
| [상세 보기] | 변수별 상세 통계 | 각 행 우측 |
| [보고서 저장] | PDF/Excel 다운로드 | 상단 |
| [다시 업로드] | Step 1로 돌아가기 | 상단 |

### 2.6.2 자동 진행 조건

다음 조건 모두 충족 시 5초 후 자동 진행:
- ✅ 최소 2개 변수 존재
- ✅ 최소 10개 관측치
- ✅ 전체 결측률 < 50%
- ✅ 치명적 오류 없음

자동 진행 시 카운트다운 표시:
```
"데이터 검증 완료. 5초 후 다음 단계로 진행합니다... [대기]"
```

## 2.7 에러 처리

### 2.7.1 경고 수준

#### 정보 (Info) ℹ️
- "일부 변수가 정규분포를 따르지 않습니다"
- "범주형 변수가 많아 회귀분석이 제한적일 수 있습니다"

#### 경고 (Warning) ⚠️
- "결측값이 20%를 초과합니다"
- "극단 이상치가 발견되었습니다"

#### 오류 (Error) ❌
- "모든 값이 동일하여 분석이 불가능합니다"
- "유효한 숫자 데이터가 없습니다"

## 2.8 성능 최적화

### 2.8.1 대용량 데이터 처리

| 데이터 크기 | 처리 방식 |
|------------|-----------|
| < 1만 행 | 동기 처리 |
| 1-10만 행 | Web Worker |
| > 10만 행 | 샘플링 후 처리 |

### 2.8.2 계산 우선순위

1. **즉시 표시**: 기본 정보 (행, 열, 타입)
2. **백그라운드**: 정규성 검정, 이상치 탐지
3. **요청 시**: 상세 통계, 시각화

## 2.9 접근성 고려사항

- **색맹 친화**: 색상 외 아이콘/텍스트 병용
- **스크린 리더**: ARIA 라벨 제공
- **키보드 네비게이션**: Tab 키로 모든 요소 접근
- **반응형 디자인**: 태블릿/모바일 대응

---

[다음: Step 3 - 분석 목표 설정 →](./STEP3_ANALYSIS_GOAL_SPEC.md)