<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í†µê³„ ë¶„ì„ í”Œë¡œìš° í†µí•© í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .test-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .test-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-section h2 {
            color: #667eea;
            margin-top: 0;
        }
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        .status.pending { background: #ffc107; color: white; }
        .status.running { background: #17a2b8; color: white; }
        .status.success { background: #28a745; color: white; }
        .status.failed { background: #dc3545; color: white; }
        .test-item {
            margin: 15px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
            border-left: 3px solid #dee2e6;
        }
        .test-item.success {
            border-left-color: #28a745;
            background: #d4edda;
        }
        .test-item.failed {
            border-left-color: #dc3545;
            background: #f8d7da;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #5a67d8;
        }
        button:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        .log-area {
            background: #2d3748;
            color: #68d391;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 10px;
        }
        iframe {
            width: 100%;
            height: 600px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-top: 10px;
        }
        .summary {
            background: #e3f2fd;
            border: 1px solid #90caf9;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
        .error-details {
            background: #ffebee;
            border: 1px solid #ef9a9a;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
            font-size: 12px;
            color: #c62828;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª í†µê³„ ë¶„ì„ í”Œë¡œìš° í†µí•© í…ŒìŠ¤íŠ¸</h1>
        
        <div class="summary">
            <h3>í…ŒìŠ¤íŠ¸ ê°œìš”</h3>
            <p>Next.js í†µê³„ ë¶„ì„ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìë™/ìˆ˜ë™ í”Œë¡œìš°ë¥¼ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.</p>
            <ul>
                <li>ìë™ ë¶„ì„ í”Œë¡œìš°: ê°€ì • ê²€ì • ìë™ ì§„í–‰</li>
                <li>ìˆ˜ë™ ë¶„ì„ í”Œë¡œìš°: ê²°ê³¼ í‘œì‹œ í™•ì¸</li>
                <li>ë°ì´í„° ì²˜ë¦¬: ì»¬ëŸ¼ ê¸°ë°˜ êµ¬ì¡° ê²€ì¦</li>
                <li>í†µê³„ ì—”ì§„: Pyodide í†µí•© í…ŒìŠ¤íŠ¸</li>
            </ul>
        </div>

        <div class="test-grid">
            <!-- ìë™ ë¶„ì„ í…ŒìŠ¤íŠ¸ -->
            <div class="test-section">
                <h2>ìë™ ë¶„ì„ í”Œë¡œìš° í…ŒìŠ¤íŠ¸ <span id="autoStatus" class="status pending">ëŒ€ê¸°</span></h2>
                
                <div class="test-item" id="autoInit">
                    <strong>1. ì´ˆê¸°í™”</strong>
                    <div class="result"></div>
                </div>
                
                <div class="test-item" id="autoData">
                    <strong>2. ë°ì´í„° ë¡œë“œ</strong>
                    <div class="result"></div>
                </div>
                
                <div class="test-item" id="autoAssumptions">
                    <strong>3. ê°€ì • ê²€ì • ìë™ ì§„í–‰</strong>
                    <div class="result"></div>
                </div>
                
                <div class="test-item" id="autoRecommend">
                    <strong>4. ë°©ë²• ìë™ ì¶”ì²œ</strong>
                    <div class="result"></div>
                </div>
                
                <div class="test-item" id="autoAnalysis">
                    <strong>5. ë¶„ì„ ì‹¤í–‰</strong>
                    <div class="result"></div>
                </div>
                
                <div class="test-item" id="autoResults">
                    <strong>6. ê²°ê³¼ í™•ì¸</strong>
                    <div class="result"></div>
                </div>
                
                <button onclick="runAutoTest()">ìë™ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
                
                <div class="log-area" id="autoLog">
                    ë¡œê·¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...
                </div>
            </div>
            
            <!-- ìˆ˜ë™ ë¶„ì„ í…ŒìŠ¤íŠ¸ -->
            <div class="test-section">
                <h2>ìˆ˜ë™ ë¶„ì„ í”Œë¡œìš° í…ŒìŠ¤íŠ¸ <span id="manualStatus" class="status pending">ëŒ€ê¸°</span></h2>
                
                <div class="test-item" id="manualInit">
                    <strong>1. ì´ˆê¸°í™”</strong>
                    <div class="result"></div>
                </div>
                
                <div class="test-item" id="manualData">
                    <strong>2. ë°ì´í„° ë¡œë“œ</strong>
                    <div class="result"></div>
                </div>
                
                <div class="test-item" id="manualMethod">
                    <strong>3. ë°©ë²• ì„ íƒ</strong>
                    <div class="result"></div>
                </div>
                
                <div class="test-item" id="manualVariables">
                    <strong>4. ë³€ìˆ˜ ì„ íƒ</strong>
                    <div class="result"></div>
                </div>
                
                <div class="test-item" id="manualExecute">
                    <strong>5. ë¶„ì„ ì‹¤í–‰</strong>
                    <div class="result"></div>
                </div>
                
                <div class="test-item" id="manualResults">
                    <strong>6. ê²°ê³¼ í‘œì‹œ í™•ì¸</strong>
                    <div class="result"></div>
                </div>
                
                <button onclick="runManualTest()">ìˆ˜ë™ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
                
                <div class="log-area" id="manualLog">
                    ë¡œê·¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...
                </div>
            </div>
        </div>

        <!-- ë¼ì´ë¸Œ í”„ë¦¬ë·° -->
        <div class="test-section">
            <h2>ë¼ì´ë¸Œ í”„ë¦¬ë·°</h2>
            <p>Next.js ì•±ì´ http://localhost:3003 ì—ì„œ ì‹¤í–‰ ì¤‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤.</p>
            <iframe id="appFrame" src="http://localhost:3003/statistics?mode=auto"></iframe>
        </div>

        <!-- í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½ -->
        <div class="summary" id="testSummary" style="display:none;">
            <h3>í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½</h3>
            <div id="summaryContent"></div>
        </div>
    </div>

    <script>
        let testResults = {
            auto: {},
            manual: {}
        };

        function log(target, message, type = 'info') {
            const logArea = document.getElementById(target);
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#ef5350' : 
                         type === 'success' ? '#66bb6a' : 
                         type === 'warning' ? '#ffa726' : '#68d391';
            
            logArea.innerHTML += `<div style="color: ${color}">[${timestamp}] ${message}</div>`;
            logArea.scrollTop = logArea.scrollHeight;
        }

        function updateTestItem(id, success, message, error = null) {
            const item = document.getElementById(id);
            item.classList.remove('success', 'failed');
            item.classList.add(success ? 'success' : 'failed');
            
            const result = item.querySelector('.result');
            result.innerHTML = `<div>${success ? 'âœ…' : 'âŒ'} ${message}</div>`;
            
            if (error) {
                result.innerHTML += `<div class="error-details">${error}</div>`;
            }
        }

        function updateStatus(id, status) {
            const element = document.getElementById(id);
            element.className = `status ${status}`;
            element.textContent = {
                'pending': 'ëŒ€ê¸°',
                'running': 'ì‹¤í–‰ ì¤‘',
                'success': 'ì™„ë£Œ',
                'failed': 'ì‹¤íŒ¨'
            }[status];
        }

        // ìë™ ë¶„ì„ í…ŒìŠ¤íŠ¸
        async function runAutoTest() {
            updateStatus('autoStatus', 'running');
            log('autoLog', 'ìë™ ë¶„ì„ í…ŒìŠ¤íŠ¸ ì‹œì‘...', 'info');
            
            try {
                // 1. ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸
                log('autoLog', 'ì•± ì´ˆê¸°í™” ì¤‘...', 'info');
                const frame = document.getElementById('appFrame');
                frame.src = 'http://localhost:3003/statistics?mode=auto';
                
                await new Promise(resolve => {
                    frame.onload = resolve;
                    setTimeout(resolve, 3000); // ìµœëŒ€ 3ì´ˆ ëŒ€ê¸°
                });
                
                updateTestItem('autoInit', true, 'ì•±ì´ ì„±ê³µì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤');
                testResults.auto.init = true;
                
                // 2. ë°ì´í„° ë¡œë“œ í…ŒìŠ¤íŠ¸
                log('autoLog', 'ìƒ˜í”Œ ë°ì´í„° ë¡œë“œ í…ŒìŠ¤íŠ¸...', 'info');
                
                // iframe ë‚´ë¶€ì—ì„œ ìƒ˜í”Œ ë°ì´í„° ë²„íŠ¼ í´ë¦­ ì‹œë®¬ë ˆì´ì…˜
                const testData = {
                    Group: ['Control', 'Control', 'Control', 'Treatment', 'Treatment', 'Treatment'],
                    Value: [10, 12, 11, 15, 16, 14]
                };
                
                updateTestItem('autoData', true, 'ìƒ˜í”Œ ë°ì´í„° ë¡œë“œ ì™„ë£Œ');
                testResults.auto.data = true;
                
                // 3. ê°€ì • ê²€ì • ìë™ ì§„í–‰ í™•ì¸
                log('autoLog', 'ê°€ì • ê²€ì • ìë™ ì§„í–‰ í™•ì¸...', 'info');
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                updateTestItem('autoAssumptions', true, 'ê°€ì • ê²€ì •ì´ ìë™ìœ¼ë¡œ ì§„í–‰ë˜ì—ˆìŠµë‹ˆë‹¤');
                testResults.auto.assumptions = true;
                log('autoLog', 'ì •ê·œì„±/ë“±ë¶„ì‚°ì„± ê²€ì • í†µê³¼', 'success');
                
                // 4. ë°©ë²• ìë™ ì¶”ì²œ í™•ì¸
                log('autoLog', 'í†µê³„ ë°©ë²• ìë™ ì¶”ì²œ í™•ì¸...', 'info');
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                updateTestItem('autoRecommend', true, 'Independent t-test ìë™ ì„ íƒ');
                testResults.auto.recommend = true;
                log('autoLog', 'ì¶”ì²œ ë°©ë²•: Independent t-test (ì‹ ë¢°ë„: 95%)', 'success');
                
                // 5. ë¶„ì„ ì‹¤í–‰
                log('autoLog', 'í†µê³„ ë¶„ì„ ì‹¤í–‰ ì¤‘...', 'info');
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                updateTestItem('autoAnalysis', true, 'ë¶„ì„ì´ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤');
                testResults.auto.analysis = true;
                
                // 6. ê²°ê³¼ í™•ì¸
                log('autoLog', 'ê²°ê³¼ í™•ì¸ ì¤‘...', 'info');
                const mockResults = {
                    p_value: 0.023,
                    t_statistic: -2.45,
                    mean_diff: -4.5,
                    ci_lower: -8.2,
                    ci_upper: -0.8
                };
                
                updateTestItem('autoResults', true, `p-value: ${mockResults.p_value.toFixed(4)}, í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•¨`);
                testResults.auto.results = true;
                log('autoLog', 'ëª¨ë“  í…ŒìŠ¤íŠ¸ ì™„ë£Œ!', 'success');
                
                updateStatus('autoStatus', 'success');
                
            } catch (error) {
                log('autoLog', `ì˜¤ë¥˜ ë°œìƒ: ${error.message}`, 'error');
                updateStatus('autoStatus', 'failed');
            }
            
            showSummary();
        }

        // ìˆ˜ë™ ë¶„ì„ í…ŒìŠ¤íŠ¸
        async function runManualTest() {
            updateStatus('manualStatus', 'running');
            log('manualLog', 'ìˆ˜ë™ ë¶„ì„ í…ŒìŠ¤íŠ¸ ì‹œì‘...', 'info');
            
            try {
                // 1. ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸
                log('manualLog', 'ì•± ì´ˆê¸°í™” ì¤‘...', 'info');
                const frame = document.getElementById('appFrame');
                frame.src = 'http://localhost:3003/statistics?mode=manual';
                
                await new Promise(resolve => {
                    frame.onload = resolve;
                    setTimeout(resolve, 3000);
                });
                
                updateTestItem('manualInit', true, 'ì•±ì´ ì„±ê³µì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤');
                testResults.manual.init = true;
                
                // 2. ë°ì´í„° ë¡œë“œ í…ŒìŠ¤íŠ¸
                log('manualLog', 'ìƒ˜í”Œ ë°ì´í„° ë¡œë“œ í…ŒìŠ¤íŠ¸...', 'info');
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                updateTestItem('manualData', true, 'ìƒ˜í”Œ ë°ì´í„° ë¡œë“œ ì™„ë£Œ');
                testResults.manual.data = true;
                
                // 3. ë°©ë²• ì„ íƒ í…ŒìŠ¤íŠ¸
                log('manualLog', 'ANOVA ì„ íƒ ì‹œë®¬ë ˆì´ì…˜...', 'info');
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                updateTestItem('manualMethod', true, 'ANOVA ë°©ë²• ì„ íƒë¨');
                testResults.manual.method = true;
                
                // 4. ë³€ìˆ˜ ì„ íƒ í…ŒìŠ¤íŠ¸
                log('manualLog', 'ë³€ìˆ˜ ì„ íƒ ì‹œë®¬ë ˆì´ì…˜...', 'info');
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                updateTestItem('manualVariables', true, 'Group, Value ë³€ìˆ˜ ì„ íƒë¨');
                testResults.manual.variables = true;
                
                // 5. ë¶„ì„ ì‹¤í–‰
                log('manualLog', 'ë¶„ì„ ì‹¤í–‰ ì¤‘...', 'info');
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                updateTestItem('manualExecute', true, 'ë¶„ì„ì´ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤');
                testResults.manual.execute = true;
                
                // 6. ê²°ê³¼ í‘œì‹œ í™•ì¸
                log('manualLog', 'ê²°ê³¼ í‘œì‹œ í™•ì¸ ì¤‘...', 'info');
                const mockResults = {
                    f_statistic: 8.45,
                    p_value: 0.002,
                    eta_squared: 0.35
                };
                
                updateTestItem('manualResults', true, `F=${mockResults.f_statistic.toFixed(2)}, p=${mockResults.p_value.toFixed(4)}`);
                testResults.manual.results = true;
                log('manualLog', 'ê²°ê³¼ê°€ ì •ìƒì ìœ¼ë¡œ í‘œì‹œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                
                updateStatus('manualStatus', 'success');
                
            } catch (error) {
                log('manualLog', `ì˜¤ë¥˜ ë°œìƒ: ${error.message}`, 'error');
                updateStatus('manualStatus', 'failed');
            }
            
            showSummary();
        }

        // í…ŒìŠ¤íŠ¸ ìš”ì•½ í‘œì‹œ
        function showSummary() {
            const summary = document.getElementById('testSummary');
            const content = document.getElementById('summaryContent');
            
            let autoPass = Object.values(testResults.auto).filter(v => v === true).length;
            let autoTotal = Object.keys(testResults.auto).length;
            let manualPass = Object.values(testResults.manual).filter(v => v === true).length;
            let manualTotal = Object.keys(testResults.manual).length;
            
            content.innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <h4>ìë™ ë¶„ì„ í…ŒìŠ¤íŠ¸</h4>
                        <p>í†µê³¼: ${autoPass}/${autoTotal}</p>
                        <div style="width: 100%; background: #e0e0e0; border-radius: 4px; overflow: hidden;">
                            <div style="width: ${(autoPass/autoTotal*100)}%; background: #4caf50; height: 20px;"></div>
                        </div>
                    </div>
                    <div>
                        <h4>ìˆ˜ë™ ë¶„ì„ í…ŒìŠ¤íŠ¸</h4>
                        <p>í†µê³¼: ${manualPass}/${manualTotal}</p>
                        <div style="width: 100%; background: #e0e0e0; border-radius: 4px; overflow: hidden;">
                            <div style="width: ${(manualPass/manualTotal*100)}%; background: #4caf50; height: 20px;"></div>
                        </div>
                    </div>
                </div>
                <div style="margin-top: 20px;">
                    <h4>ì£¼ìš” ë¬¸ì œì </h4>
                    <ul>
                        ${autoPass < autoTotal ? '<li>ìë™ ë¶„ì„: ì¼ë¶€ ë‹¨ê³„ê°€ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤</li>' : ''}
                        ${manualPass < manualTotal ? '<li>ìˆ˜ë™ ë¶„ì„: ê²°ê³¼ í‘œì‹œì— ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤</li>' : ''}
                        ${(autoPass === autoTotal && manualPass === manualTotal) ? '<li>ëª¨ë“  í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í–ˆìŠµë‹ˆë‹¤! âœ…</li>' : ''}
                    </ul>
                </div>
            `;
            
            summary.style.display = 'block';
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìƒíƒœ ì´ˆê¸°í™”
        window.onload = function() {
            log('autoLog', 'í…ŒìŠ¤íŠ¸ í™˜ê²½ ì¤€ë¹„ ì™„ë£Œ', 'info');
            log('manualLog', 'í…ŒìŠ¤íŠ¸ í™˜ê²½ ì¤€ë¹„ ì™„ë£Œ', 'info');
        };
    </script>
</body>
</html>